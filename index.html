<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Theblitz : An attempt to map the bombs of the blitz over london" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Theblitz</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/espinielli/theblitz">View on GitHub</a>

          <h1 id="project_title">Theblitz</h1>
          <h2 id="project_tagline">An attempt to map the bombs of the blitz over london</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/espinielli/theblitz/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/espinielli/theblitz/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>theblitz Project</h1>

<p>An attempt to map the bombs of the blitz over London.
The idea is to learn to use d3.js and have a video-like effect as in
the <a href="http://bost.ocks.org/mike/nations/" title="The Wealth of Nations ">the wealth of nations example</a>.
(Or make a stop motion video out of it...)</p>

<h1>The Data</h1>

<p>The nice article and datablog entry of The Guardian --
<a href="http://www.guardian.co.uk/news/datablog/2010/sep/06/london-blitz-bomb-map-september-7-1940" title="The first day of the London Blitz">'London Blitz 1940: the first day's bomb attacks listed in full'</a>
provides access to the historical records of the first air raid over London in 1940.
It is a spreadsheet listing for 843 drops, the time, the address, the type of
bomb and the damage caused.
The times are for 7th Sep 1940.
I converted it to CSV - with ';' as separator - and stored the result
in this project.</p>

<h2>Obtaining lat/lon for the drops</h2>

<p>I tried various approaches to geocode the addresses in the data set:</p>

<ul>
<li>using <a href="https://github.com/agabel/python-nominatim" title="nominatim ">nominatim-python</a>, a python library for <a href="http://wiki.openstreetmap.org/wiki/Nominatim" title="nominatim reverse geocoding">Nominatim</a>.</li>
</ul><h3>Geocoding via Nominatim</h3>

<p>The lookup of the 73rd entry in <a href="https://docs.google.com/spreadsheet/ccc?key=0AonYZs4MzlZbdGZyNDJtd0d0ZFhvRTBxOFAyMkRFeUE&amp;hl=en#gid=0" title="the spreadsheet for the bombs of first day of London Blitz">the data</a> file, </p>

<blockquote>
<p>Royal Arsenal, Woolwich, SE18, London, UK</p>
</blockquote>

<p>gives</p>

<div class="highlight">
<pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">nominatim</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">json</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">address_lookup</span><span class="o">=</span><span class="n">nominatim</span><span class="o">.</span><span class="n">Geocoder</span><span class="p">()</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="s">'Royal Arsenal, Woolwich, SE18, London, UK'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">address_lookup</span><span class="p">)</span>
<span class="p">[</span>
    <span class="p">{</span>
        <span class="s">"display_name"</span><span class="p">:</span> <span class="s">"Royal Arsenal Woolwich Pier, Woolwich, London Borough of Greenwich, Greater London, London, England, SE18, United Kingdom"</span><span class="p">,</span> 
        <span class="s">"place_id"</span><span class="p">:</span> <span class="s">"2112469544"</span><span class="p">,</span> 
        <span class="s">"lon"</span><span class="p">:</span> <span class="s">"0.070824870400824"</span><span class="p">,</span> 
        <span class="s">"lat"</span><span class="p">:</span> <span class="s">"51.4956072184614"</span><span class="p">,</span> 
        <span class="s">"osm_type"</span><span class="p">:</span> <span class="s">"way"</span><span class="p">,</span> 
        <span class="s">"licence"</span><span class="p">:</span> <span class="s">"Data Copyright OpenStreetMap Contributors, Some Rights Reserved. CC-BY-SA 2.0."</span><span class="p">,</span> 
        <span class="s">"osm_id"</span><span class="p">:</span> <span class="s">"103128361"</span><span class="p">,</span> 
        <span class="s">"boundingbox"</span><span class="p">:</span> <span class="p">[</span>
            <span class="s">"51.4951553344727"</span><span class="p">,</span> 
            <span class="s">"51.495906829834"</span><span class="p">,</span> 
            <span class="s">"0.0705746933817863"</span><span class="p">,</span> 
            <span class="s">"0.0711841061711311"</span>
        <span class="p">],</span> 
        <span class="s">"type"</span><span class="p">:</span> <span class="s">"pedestrian"</span><span class="p">,</span> 
        <span class="s">"class"</span><span class="p">:</span> <span class="s">"highway"</span><span class="p">,</span> 
        <span class="s">"address"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">"city"</span><span class="p">:</span> <span class="s">"London Borough of Greenwich"</span><span class="p">,</span> 
            <span class="s">"state_district"</span><span class="p">:</span> <span class="s">"London"</span><span class="p">,</span> 
            <span class="s">"suburb"</span><span class="p">:</span> <span class="s">"Woolwich"</span><span class="p">,</span> 
            <span class="s">"country"</span><span class="p">:</span> <span class="s">"United Kingdom"</span><span class="p">,</span> 
            <span class="s">"county"</span><span class="p">:</span> <span class="s">"Greater London"</span><span class="p">,</span> 
            <span class="s">"pedestrian"</span><span class="p">:</span> <span class="s">"Royal Arsenal Woolwich Pier"</span><span class="p">,</span> 
            <span class="s">"state"</span><span class="p">:</span> <span class="s">"England"</span><span class="p">,</span> 
            <span class="s">"postcode"</span><span class="p">:</span> <span class="s">"SE18"</span><span class="p">,</span> 
            <span class="s">"country_code"</span><span class="p">:</span> <span class="s">"gb"</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre>
</div>


<h3>Geocoding via Google Maps v3</h3>

<p>It turns out that a lot of addresses are not geocoded by Nominatim,
for example entry 225 </p>

<blockquote>
<p>128 Aylward Street, Stepney E1, London, UK</p>
</blockquote>

<p>So I tried Google Maps v3 using <a href="http://code.xster.net/pygeocoder" title="pygeocoder">pygeocoder</a> library:</p>

<div class="highlight">
<pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">pygeocoder</span> <span class="kn">as</span> <span class="nn">geo</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">json</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">drop</span> <span class="o">=</span> <span class="s">'128 Aylward Street, Stepney E1, London, UK'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">gm_lookup</span> <span class="o">=</span> <span class="n">pygeocoder</span><span class="o">.</span><span class="n">Geocoder</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">drop</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">gm_lookup</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="p">[</span>
    <span class="p">{</span>
        <span class="s">"geometry"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">"location"</span><span class="p">:</span> <span class="p">{</span>
                <span class="s">"lat"</span><span class="p">:</span> <span class="mf">51.5159781</span><span class="p">,</span> 
                <span class="s">"lng"</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.0462063</span>
            <span class="p">},</span> 
            <span class="s">"viewport"</span><span class="p">:</span> <span class="p">{</span>
                <span class="s">"northeast"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s">"lat"</span><span class="p">:</span> <span class="mf">51.5173270802915</span><span class="p">,</span> 
                    <span class="s">"lng"</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.04485731970849797</span>
                <span class="p">},</span> 
                <span class="s">"southwest"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s">"lat"</span><span class="p">:</span> <span class="mf">51.5146291197085</span><span class="p">,</span> 
                    <span class="s">"lng"</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.04755528029150203</span>
                <span class="p">}</span>
            <span class="p">},</span> 
            <span class="s">"location_type"</span><span class="p">:</span> <span class="s">"ROOFTOP"</span>
        <span class="p">},</span> 
        <span class="s">"address_components"</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s">"long_name"</span><span class="p">:</span> <span class="s">"128"</span><span class="p">,</span> 
                <span class="s">"types"</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s">"street_number"</span>
                <span class="p">],</span> 
                <span class="s">"short_name"</span><span class="p">:</span> <span class="s">"128"</span>
            <span class="p">},</span> 
            <span class="p">{</span>
                <span class="s">"long_name"</span><span class="p">:</span> <span class="s">"Aylward St"</span><span class="p">,</span> 
                <span class="s">"types"</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s">"route"</span>
                <span class="p">],</span> 
                <span class="s">"short_name"</span><span class="p">:</span> <span class="s">"Aylward St"</span>
            <span class="p">},</span> 
            <span class="p">{</span>
                <span class="s">"long_name"</span><span class="p">:</span> <span class="s">"London"</span><span class="p">,</span> 
                <span class="s">"types"</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s">"locality"</span><span class="p">,</span> 
                    <span class="s">"political"</span>
                <span class="p">],</span> 
                <span class="s">"short_name"</span><span class="p">:</span> <span class="s">"London"</span>
            <span class="p">},</span> 
            <span class="p">{</span>
                <span class="s">"long_name"</span><span class="p">:</span> <span class="s">"Greater London"</span><span class="p">,</span> 
                <span class="s">"types"</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s">"administrative_area_level_2"</span><span class="p">,</span> 
                    <span class="s">"political"</span>
                <span class="p">],</span> 
                <span class="s">"short_name"</span><span class="p">:</span> <span class="s">"Gt Lon"</span>
            <span class="p">},</span> 
            <span class="p">{</span>
                <span class="s">"long_name"</span><span class="p">:</span> <span class="s">"United Kingdom"</span><span class="p">,</span> 
                <span class="s">"types"</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s">"country"</span><span class="p">,</span> 
                    <span class="s">"political"</span>
                <span class="p">],</span> 
                <span class="s">"short_name"</span><span class="p">:</span> <span class="s">"GB"</span>
            <span class="p">},</span> 
            <span class="p">{</span>
                <span class="s">"long_name"</span><span class="p">:</span> <span class="s">"E1 0QW"</span><span class="p">,</span> 
                <span class="s">"types"</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s">"postal_code"</span>
                <span class="p">],</span> 
                <span class="s">"short_name"</span><span class="p">:</span> <span class="s">"E1 0QW"</span>
            <span class="p">},</span> 
            <span class="p">{</span>
                <span class="s">"long_name"</span><span class="p">:</span> <span class="s">"London"</span><span class="p">,</span> 
                <span class="s">"types"</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s">"postal_town"</span>
                <span class="p">],</span> 
                <span class="s">"short_name"</span><span class="p">:</span> <span class="s">"London"</span>
            <span class="p">}</span>
        <span class="p">],</span> 
        <span class="s">"partial_match"</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span> 
        <span class="s">"formatted_address"</span><span class="p">:</span> <span class="s">"128 Aylward St, London, Greater London E1 0QW, UK"</span><span class="p">,</span> 
        <span class="s">"types"</span><span class="p">:</span> <span class="p">[</span>
            <span class="s">"street_address"</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre>
</div>


<p>But even Google Maps fails, for example on entry 224</p>

<blockquote>
<p>12 Jewel Street, Stepney E1, London, UK
This street probably does not exist any more.</p>
</blockquote>

<p>File addressesNotFound.txt lists the addresses I could not geocode automagically. 
I did spot some of them using scanned maps of London from <a href="http://mapco.net/bart1908/bart38b.htm" title="London map ca. 1908">1908</a> and
<a href="http://www.maps-of-london.com/" title="London map ca. 1940">1940</a> or guessed.</p>

<h1>Timeline</h1>

<h1></h1>

<p>I would like to use <a href="http://d3js.org/" title="Data-Driven Documents javascript library">d3.js</a> like in
<a href="http://bost.ocks.org/mike/nations/" title="The Wealth of Nations ">the wealth of nations</a> example, i.e. with an animation.
The raid started after 16:14 when the German bombers entered British airspace.
So the times from in the Guardian spreadsheet need to be date stamped.</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Theblitz maintained by <a href="https://github.com/espinielli">espinielli</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
